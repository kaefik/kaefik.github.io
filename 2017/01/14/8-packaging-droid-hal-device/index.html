<!DOCTYPE html>
<html lang="ru">
<head>
        <meta charset="utf-8" />
        <meta name="yandex-verification" content="f7918c520c4b54dd" />
        <title>8. Packaging droid-hal-device</title>
        <link rel="stylesheet" href="/theme/css/main.css" />

        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
<a href="https://github.com/kaefik">
<img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub" />
</a>
        <header id="banner" class="body">
                <h1><a href="/">Общественная записная книжка  <strong>следы для себя и потомков</strong></a></h1>
                <nav><ul>
                </ul>
<form id="search" action"#" onsubmit="javascript:window.open('https://duckduckgo.com/?q='+document.getElementById('keywords').value+'+site:www.kaefik.ru');">
                        <input id="keywords" type="text" />
                    </form>
                </nav>
<div id="submenu">
                    <ul>
                            <li><a href="/category/anime.html">anime</a></li>
                            <li><a href="/category/arduino.html">arduino</a></li>
                            <li><a href="/category/bios.html">bios</a></li>
                            <li><a href="/category/blogger.html">blogger</a></li>
                            <li><a href="/category/c.html">c#</a></li>
                            <li><a href="/category/chromeos.html">chromeos</a></li>
                            <li><a href="/category/clojure.html">clojure</a></li>
                            <li><a href="/category/design.html">design</a></li>
                            <li><a href="/category/docker.html">docker</a></li>
                            <li><a href="/category/emacs.html">emacs</a></li>
                            <li><a href="/category/english.html">english</a></li>
                            <li><a href="/category/familytree.html">familytree</a></li>
                            <li><a href="/category/freepbx.html">freepbx</a></li>
                            <li><a href="/category/game.html">game</a></li>
                            <li><a href="/category/git.html">git</a></li>
                            <li><a href="/category/github-actions.html">github-actions</a></li>
                            <li><a href="/category/go.html">go</a></li>
                            <li><a href="/category/hackintosh.html">hackintosh</a></li>
                            <li><a href="/category/hobby.html">hobby</a></li>
                            <li><a href="/category/internet.html">internet</a></li>
                            <li><a href="/category/java.html">java</a></li>
                            <li><a href="/category/javascript.html">javascript</a></li>
                            <li><a href="/category/lego.html">lego</a></li>
                            <li><a href="/category/linux.html">linux</a></li>
                            <li><a href="/category/lua.html">lua</a></li>
                            <li><a href="/category/machine_learning.html">machine_learning</a></li>
                            <li><a href="/category/main.html">main</a></li>
                            <li><a href="/category/markdown.html">markdown</a></li>
                            <li><a href="/category/miband.html">miband</a></li>
                            <li><a href="/category/minecraft.html">minecraft</a></li>
                            <li><a href="/category/miui.html">miui</a></li>
                            <li><a href="/category/money.html">money</a></li>
                            <li><a href="/category/mongodb.html">mongodb</a></li>
                            <li><a href="/category/mouse.html">mouse</a></li>
                            <li><a href="/category/nano.html">nano</a></li>
                            <li><a href="/category/network.html">network</a></li>
                            <li><a href="/category/openstreetmap.html">openstreetmap</a></li>
                            <li><a href="/category/os.html">os</a></li>
                            <li><a href="/category/otkrytye-dannye.html">открытые данные</a></li>
                            <li><a href="/category/postgis.html">postgis</a></li>
                            <li><a href="/category/postgresql.html">PostgreSQL</a></li>
                            <li><a href="/category/powershell.html">powershell</a></li>
                            <li><a href="/category/programming.html">programming</a></li>
                            <li><a href="/category/projects.html">projects</a></li>
                            <li><a href="/category/python.html">python</a></li>
                            <li><a href="/category/radio.html">radio</a></li>
                            <li><a href="/category/rest-api.html">rest-api</a></li>
                            <li><a href="/category/rust.html">rust</a></li>
                            <li class="active"><a href="/category/sailfish.html">sailfish</a></li>
                            <li><a href="/category/security.html">security</a></li>
                            <li><a href="/category/selenium.html">selenium</a></li>
                            <li><a href="/category/shell.html">shell</a></li>
                            <li><a href="/category/swift.html">swift</a></li>
                            <li><a href="/category/tatar.html">tatar</a></li>
                            <li><a href="/category/ubuntu.html">ubuntu</a></li>
                            <li><a href="/category/upwork.html">upwork</a></li>
                            <li><a href="/category/video.html">video</a></li>
                            <li><a href="/category/vim.html">vim</a></li>
                            <li><a href="/category/voice-assistant.html">voice-assistant</a></li>
                            <li><a href="/category/vpn.html">vpn</a></li>
                            <li><a href="/category/vscode.html">vscode</a></li>
                            <li><a href="/category/web.html">web</a></li>
                            <li><a href="/category/wifi.html">wifi</a></li>
                            <li><a href="/category/windows.html">windows</a></li>
                    </ul>
                <div>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2017/01/14/8-packaging-droid-hal-device/" rel="bookmark"
           title="Permalink to 8. Packaging droid-hal-device">8. Packaging droid-hal-device</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <span>Sat 14 January 2017</span>
<span>| tags: <a href="/tag/asus.html">asus</a><a href="/tag/porting.html">porting</a><a href="/tag/sailfish.html">sailfish</a><a href="/tag/z00l.html">z00l</a></span>
</footer><!-- /.post-info -->      <p>Далее нужно выполнить простроение дерева rpm пакетов, но перед эти лучше выполнить следующие команды которые избавят вас от ошибок которые описаны ниже (для тех кто делает впервые лучше посмотреть будут ли выходить эти ошибки):</p>
<div class="highlight"><pre><span></span>sb2<span class="w"> </span>-t<span class="w"> </span><span class="nv">$VENDOR</span>-<span class="nv">$DEVICE</span>-<span class="nv">$PORT_ARCH</span><span class="w"> </span>-m<span class="w"> </span>sdk-install<span class="w"> </span>-R<span class="w"> </span>zypper<span class="w"> </span>rm<span class="w"> </span>mesa-llvmpipe-9.2.5+git2-1.3.23.armv7hl
sb2<span class="w"> </span>-t<span class="w"> </span><span class="nv">$VENDOR</span>-<span class="nv">$DEVICE</span>-<span class="nv">$PORT_ARCH</span><span class="w"> </span>-m<span class="w"> </span>sdk-install<span class="w"> </span>-R<span class="w"> </span>zypper<span class="w"> </span>ar<span class="w"> </span>http://repo.merproject.org/obs/nemo:/devel:/hw:/common/sailfish_latest_armv7hl/<span class="w"> </span>slf
sb2<span class="w"> </span>-t<span class="w"> </span><span class="nv">$VENDOR</span>-<span class="nv">$DEVICE</span>-<span class="nv">$PORT_ARCH</span><span class="w"> </span>-m<span class="w"> </span>sdk-install<span class="w"> </span>-R<span class="w"> </span>zypper<span class="w"> </span><span class="k">in</span><span class="w"> </span>kf5bluezqt-bluez4*
sb2<span class="w"> </span>-t<span class="w"> </span><span class="nv">$VENDOR</span>-<span class="nv">$DEVICE</span>-<span class="nv">$PORT_ARCH</span><span class="w"> </span>-m<span class="w"> </span>sdk-install<span class="w"> </span>-R<span class="w"> </span>zypper<span class="w"> </span>rm<span class="w"> </span>bluez-configs-mer-4.101+git73-1.31.1.armv7hl
</pre></div>


<p>потом после исправление ошибко можете запускать скрипт:</p>
<div class="highlight"><pre><span></span>MER_SDK<span class="w"> </span>$
<span class="nb">cd</span><span class="w"> </span><span class="nv">$ANDROID_ROOT</span>
rpm/dhd/helpers/build_packages.sh
</pre></div>


<p>This should compile all the needed packages, patterns, middleware and put them under local repository. If anything needs modified, just re-run this script.</p>
<h2>Далее будут те ошибки с которыми я столкнулся при отработке скрипта rpm/dhd/helpers/build_packages.sh :</h2>
<ul>
<li><strong>Ошибка</strong> </li>
</ul>
<div class="highlight"><pre><span></span>MerSDK<span class="w"> </span>ilnur@ubuntu:~/to/mer/android/droid$<span class="w"> </span>rpm/dhd/helpers/build_packages.sh
*<span class="w"> </span>Building<span class="w"> </span>rpm/droid-hal-Z00L.spec
/home/ilnur/to/mer/android/droid/system/core/include/private/android_filesystem_config.h:227:6:<span class="w"> </span>note:<span class="w"> </span>declared<span class="w"> </span>here
apply-permissions.c:117:9:<span class="w"> </span>warning:<span class="w"> </span>implicit<span class="w"> </span>declaration<span class="w"> </span>of<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="s1">&#39;strerror&#39;</span><span class="w"> </span><span class="o">[</span>-Wimplicit-function-declaration<span class="o">]</span>
apply-permissions.c:117:9:<span class="w"> </span>warning:<span class="w"> </span>format<span class="w"> </span><span class="s1">&#39;%s&#39;</span><span class="w"> </span>expects<span class="w"> </span>argument<span class="w"> </span>of<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;char *&#39;</span>,<span class="w"> </span>but<span class="w"> </span>argument<span class="w"> </span><span class="m">5</span><span class="w"> </span>has<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;int&#39;</span><span class="w"> </span><span class="o">[</span>-Wformat<span class="o">]</span>
apply-permissions.c:126:9:<span class="w"> </span>warning:<span class="w"> </span>format<span class="w"> </span><span class="s1">&#39;%s&#39;</span><span class="w"> </span>expects<span class="w"> </span>argument<span class="w"> </span>of<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;char *&#39;</span>,<span class="w"> </span>but<span class="w"> </span>argument<span class="w"> </span><span class="m">6</span><span class="w"> </span>has<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;int&#39;</span><span class="w"> </span><span class="o">[</span>-Wformat<span class="o">]</span>
apply-permissions.c:<span class="w"> </span>In<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="s1">&#39;main&#39;</span>:
apply-permissions.c:160:9:<span class="w"> </span>warning:<span class="w"> </span>implicit<span class="w"> </span>declaration<span class="w"> </span>of<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="s1">&#39;strcmp&#39;</span><span class="w"> </span><span class="o">[</span>-Wimplicit-function-declaration<span class="o">]</span>
apply-permissions.c:175:9:<span class="w"> </span>warning:<span class="w"> </span>implicit<span class="w"> </span>declaration<span class="w"> </span>of<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="s1">&#39;strlen&#39;</span><span class="w"> </span><span class="o">[</span>-Wimplicit-function-declaration<span class="o">]</span>
apply-permissions.c:175:33:<span class="w"> </span>warning:<span class="w"> </span>incompatible<span class="w"> </span>implicit<span class="w"> </span>declaration<span class="w"> </span>of<span class="w"> </span>built-in<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="s1">&#39;strlen&#39;</span><span class="w"> </span><span class="o">[</span>enabled<span class="w"> </span>by<span class="w"> </span>default<span class="o">]</span>
apply-permissions.c:178:9:<span class="w"> </span>warning:<span class="w"> </span>implicit<span class="w"> </span>declaration<span class="w"> </span>of<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="s1">&#39;strrchr&#39;</span><span class="w"> </span><span class="o">[</span>-Wimplicit-function-declaration<span class="o">]</span>
apply-permissions.c:178:16:<span class="w"> </span>warning:<span class="w"> </span>incompatible<span class="w"> </span>implicit<span class="w"> </span>declaration<span class="w"> </span>of<span class="w"> </span>built-in<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="s1">&#39;strrchr&#39;</span><span class="w"> </span><span class="o">[</span>enabled<span class="w"> </span>by<span class="w"> </span>default<span class="o">]</span>
make:<span class="w"> </span>***<span class="w"> </span><span class="o">[</span>apply-permissions<span class="o">]</span><span class="w"> </span>Error<span class="w"> </span><span class="m">1</span>
+<span class="w"> </span><span class="nb">echo</span><span class="w"> </span>Building<span class="w"> </span>uid<span class="w"> </span>scripts
Building<span class="w"> </span>uid<span class="w"> </span>scripts
+<span class="w"> </span>rpm/dhd/helpers/usergroupgen<span class="w"> </span>add
/var/tmp/rpm-tmp.XMo6Xf:<span class="w"> </span>line<span class="w"> </span><span class="m">66</span>:<span class="w"> </span>rpm/dhd/helpers/usergroupgen:<span class="w"> </span>No<span class="w"> </span>such<span class="w"> </span>file<span class="w"> </span>or<span class="w"> </span>directory
error:<span class="w"> </span>Bad<span class="w"> </span><span class="nb">exit</span><span class="w"> </span>status<span class="w"> </span>from<span class="w"> </span>/var/tmp/rpm-tmp.XMo6Xf<span class="w"> </span><span class="o">(</span>%build<span class="o">)</span>

RPM<span class="w"> </span>build<span class="w"> </span>errors:
<span class="w">    </span>Bad<span class="w"> </span><span class="nb">exit</span><span class="w"> </span>status<span class="w"> </span>from<span class="w"> </span>/var/tmp/rpm-tmp.XMo6Xf<span class="w"> </span><span class="o">(</span>%build<span class="o">)</span>
*<span class="w"> </span>Check<span class="w"> </span>/home/ilnur/to/mer/android/droid/droid-hal-Z00L.log<span class="w"> </span><span class="k">for</span><span class="w"> </span>full<span class="w"> </span>log.
!!<span class="w"> </span>building<span class="w"> </span>of<span class="w"> </span>package<span class="w"> </span>failed
</pre></div>


<p>Исправление ошибки для cm-13.0: (спасибо https://github.com/ballock/droid-hal-device/commit/7d190e9060a4a9badea1fd18a13d7bf4d38fcaf5)
Также https://github.com/mer-hybris/droid-hal-device/issues/126</p>
<h3>$ANDROID_ROOT/rpm/dhd/helpers  в файле makefile :</h3>
<div class="highlight"><pre><span></span><span class="o">-</span><span class="nv">TOOLS</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nv">apply</span><span class="o">-</span><span class="nv">permissions</span><span class="w"> </span><span class="nv">usergroupgen</span>
<span class="o">+</span><span class="nv">TOOLS</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nv">usergroupgen</span>
</pre></div>


<ul>
<li><strong>Ошибка</strong> :</li>
</ul>
<div class="highlight"><pre><span></span>Resolving<span class="w"> </span>package<span class="w"> </span>dependencies...<span class="w"> </span>
Resolving<span class="w"> </span>package<span class="w"> </span>dependencies...<span class="w"> </span>
<span class="m">4</span><span class="w"> </span>Problems:<span class="w"> </span>
Problem:<span class="w"> </span>libhybris-0.0.0-1.armv7hl<span class="w"> </span>conflicts<span class="w"> </span>with<span class="w"> </span>mesa-llvmpipe<span class="w"> </span>provided<span class="w"> </span>by<span class="w"> </span>mesa-llvmpipe-9.2.5+git2-1.3.23.armv7hl<span class="w"> </span>
Problem:<span class="w"> </span>mesa-llvmpipe-libglapi-9.2.5+git2-1.3.23.armv7hl<span class="w"> </span>requires<span class="w"> </span>mesa-llvmpipe<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">9</span>.2.5+git2-1.3.23,<span class="w"> </span>but<span class="w"> </span>this<span class="w"> </span>requirement<span class="w"> </span>cannot<span class="w"> </span>be<span class="w"> </span>provided<span class="w"> </span>
Problem:<span class="w"> </span>mesa-llvmpipe-libGLESv2-9.2.5+git2-1.3.23.armv7hl<span class="w"> </span>requires<span class="w"> </span>mesa-llvmpipe<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">9</span>.2.5+git2-1.3.23,<span class="w"> </span>but<span class="w"> </span>this<span class="w"> </span>requirement<span class="w"> </span>cannot<span class="w"> </span>be<span class="w"> </span>provided<span class="w"> </span>
Problem:<span class="w"> </span>mesa-llvmpipe-libEGL-9.2.5+git2-1.3.23.armv7hl<span class="w"> </span>requires<span class="w"> </span>mesa-llvmpipe<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">9</span>.2.5+git2-1.3.23,<span class="w"> </span>but<span class="w"> </span>this<span class="w"> </span>requirement<span class="w"> </span>cannot<span class="w"> </span>be<span class="w"> </span>provided<span class="w"> </span>
</pre></div>


<p><strong>Решение</strong></p>
<p>Удаление пакета mesa-llvmpipe-9.2.5+git2-1.3.23.armv7hl </p>
<div class="highlight"><pre><span></span>sb2<span class="w"> </span>-t<span class="w"> </span><span class="nv">$VENDOR</span>-<span class="nv">$DEVICE</span>-<span class="nv">$PORT_ARCH</span><span class="w"> </span>-m<span class="w"> </span>sdk-install<span class="w"> </span>-R<span class="w"> </span>zypper<span class="w"> </span>rm<span class="w"> </span>mesa-llvmpipe-9.2.5+git2-1.3.23.armv7hl<span class="w"> </span>
</pre></div>


<p>Лог pulseaudio-modules-droid.log ошибка: </p>
<div class="highlight"><pre><span></span>+<span class="w"> </span>make<span class="w"> </span>
make<span class="w">  </span>all-recursive<span class="w"> </span>
make<span class="o">[</span><span class="m">1</span><span class="o">]</span>:<span class="w"> </span>Entering<span class="w"> </span>directory<span class="w"> </span><span class="sb">`</span>/home/ilnur/to/mer/android/droid/hybris/mw/pulseaudio-modules-droid<span class="s1">&#39; </span>
<span class="s1">Making all in src </span>
<span class="s1">make[2]: Entering directory `/home/ilnur/to/mer/android/droid/hybris/mw/pulseaudio-modules-droid/src&#39;</span><span class="w"> </span>
Making<span class="w"> </span>all<span class="w"> </span><span class="k">in</span><span class="w"> </span>common<span class="w"> </span>
make<span class="o">[</span><span class="m">3</span><span class="o">]</span>:<span class="w"> </span>Entering<span class="w"> </span>directory<span class="w"> </span><span class="sb">`</span>/home/ilnur/to/mer/android/droid/hybris/mw/pulseaudio-modules-droid/src/common<span class="err">&#39;</span><span class="w"> </span>
<span class="w">  </span>CC<span class="w">       </span>libdroid_util_la-droid-util.lo<span class="w"> </span>
In<span class="w"> </span>file<span class="w"> </span>included<span class="w"> </span>from<span class="w"> </span>droid-util.c:60:0:<span class="w"> </span>
droid-util.h:49:2:<span class="w"> </span>error:<span class="w"> </span><span class="c1">#error &quot;No valid ANDROID_VERSION found.&quot; </span>
</pre></div>


<p><strong>Решение:</strong></p>
<p>Проблема в том что нет поддержки андроида вверсии 6.0</p>
<p>Здесь указан временный способ поддержки android 6.0 в заголовке droid-util-60.h </p>
<p>https://github.com/mer-hybris/pulseaudio-modules-droid/issues/54</p>
<p><a href="https://github.com/binli">binli</a> commented <a href="https://github.com/mer-hybris/pulseaudio-modules-droid/issues/54#issue-158822995">on Jun 7, 2016</a> </p>
<p>Hi, Now I prepared to support android 6.0, I found there are droid-util-44.h, droid-util-44.h and droid-util-51.h headers file, and I compared these files, found a lot of different between each. So how do we generated the droid-util-xx.h files? I used a temp way to copy the droid-util-51.h to droid-util-60.h, it could be build successfully. What do I need to do to improve this header file for android 6.0? Thanks! </p>
<p>Закоментировал строки содержащие строки в которых содержатся ошибки: </p>
<div class="highlight"><pre><span></span>droid-util-60.h:104:7:<span class="w"> </span>error:<span class="w"> </span><span class="s1">&#39;AUDIO_DEVICE_IN_FM_RX&#39;</span><span class="w"> </span>undeclared<span class="w"> </span>here<span class="w"> </span><span class="o">(</span>not<span class="w"> </span><span class="k">in</span><span class="w"> </span>a<span class="w"> </span><span class="k">function</span><span class="o">)</span><span class="w"> </span>
droid-util-60.h:104:53:<span class="w"> </span>error:<span class="w"> </span><span class="s1">&#39;AUDIO_SOURCE_FM_RX&#39;</span><span class="w"> </span>undeclared<span class="w"> </span>here<span class="w"> </span><span class="o">(</span>not<span class="w"> </span><span class="k">in</span><span class="w"> </span>a<span class="w"> </span><span class="k">function</span><span class="o">)</span><span class="w"> </span>
droid-util-60.h:105:7:<span class="w"> </span>error:<span class="w"> </span><span class="s1">&#39;AUDIO_DEVICE_IN_FM_RX_A2DP&#39;</span><span class="w"> </span>undeclared<span class="w"> </span>here<span class="w"> </span><span class="o">(</span>not<span class="w"> </span><span class="k">in</span><span class="w"> </span>a<span class="w"> </span><span class="k">function</span><span class="o">)</span><span class="w"> </span>
droid-util-60.h:105:53:<span class="w"> </span>error:<span class="w"> </span><span class="s1">&#39;AUDIO_SOURCE_FM_RX_A2DP&#39;</span><span class="w"> </span>undeclared<span class="w"> </span>here<span class="w"> </span><span class="o">(</span>not<span class="w"> </span><span class="k">in</span><span class="w"> </span>a<span class="w"> </span><span class="k">function</span><span class="o">)</span><span class="w"> </span>
droid-util-60.h:148:5:<span class="w"> </span>error:<span class="w"> </span><span class="s1">&#39;AUDIO_DEVICE_OUT_FM_TX&#39;</span><span class="w"> </span>undeclared<span class="w"> </span>here<span class="w"> </span><span class="o">(</span>not<span class="w"> </span><span class="k">in</span><span class="w"> </span>a<span class="w"> </span><span class="k">function</span><span class="o">)</span>
</pre></div>


<ul>
<li>Ошибка:</li>
</ul>
<p><code>* Building rpm/droid-hal-version-Z00L.spec  
  Problem: nothing provides kf5bluezqt-bluez4 needed by droid-config-Z00L-bluez4-1-1.armv7hl 
   Solution 1: do not ask to install a solvable providing droid-config 
   Solution 2: break droid-config-Z00L-bluez4-1-1.armv7hl by ignoring some of its dependencies  
  Choose from above solutions by number or skip, retry or cancel [1/2/s/r/c] (c): c 
  error: Failed build dependencies: 
  droid-hal is needed by droid-hal-version-Z00L-0.0.1-1.armv7hl 
  droid-config is needed by droid-hal-version-Z00L-0.0.1-1.armv7hl 
  droid-config-sailfish is needed by droid-hal-version-Z00L-0.0.1-1.armv7hl 
  droid-hal-kernel is needed by droid-hal-version-Z00L-0.0.1-1.armv7hl 
  droid-hal-img-boot is needed by droid-hal-version-Z00L-0.0.1-1.armv7hl 
  droid-hal-img-recovery is needed by droid-hal-version-Z00L-0.0.1-1.armv7hl 
  droid-config-preinit-plugins is needed by droid-hal-version-Z00L-0.0.1-1.armv7hl 
  droid-config-pulseaudio-settings is needed by droid-hal-version-Z00L-0.0.1-1.armv7hl 
  * Check /home/ilnur/to/mer/android/droid/hybris/droid-hal-version-Z00L.log for full log.  
  !! building of package failed</code></p>
<p><strong>Решение</strong></p>
<p>http://www.merproject.org/logs/%23sailfishos-porters/%23sailfishos-porters.2017-01-10.log.html </p>
<p>установить репозиторий и установить недостающий пакет:</p>
<div class="highlight"><pre><span></span>sb2<span class="w"> </span>-t<span class="w"> </span><span class="nv">$VENDOR</span>-<span class="nv">$DEVICE</span>-<span class="nv">$PORT_ARCH</span><span class="w"> </span>-m<span class="w"> </span>sdk-install<span class="w"> </span>-R<span class="w"> </span>zypper<span class="w"> </span>ar<span class="w"> </span>http://repo.merproject.org/obs/nemo:/devel:/hw:/common/sailfish_latest_armv7hl/<span class="w"> </span>slf<span class="w"> </span>

sb2<span class="w"> </span>-t<span class="w"> </span><span class="nv">$VENDOR</span>-<span class="nv">$DEVICE</span>-<span class="nv">$PORT_ARCH</span><span class="w"> </span>-m<span class="w"> </span>sdk-install<span class="w"> </span>-R<span class="w"> </span>zypper<span class="w"> </span><span class="k">in</span><span class="w"> </span>kf5bluezqt-bluez4*<span class="w"> </span>
</pre></div>


<p>Добавить новый репозиторий:  zypper ar <url> <name> </p>
<p>См http://www.opennet.ru/tips/info/1762.shtml </p>
<ul>
<li><strong>Ошибка:</strong></li>
</ul>
<p>```bash
  * Building rpm/droid-hal-version-Z00L.spec<br>
  Problem: droid-config-Z00L-1-1.armv7hl requires Z00L-bluez-configs, but this requirement cannot be provided 
    uninstallable providers: droid-config-Z00L-bluez4-1-1.armv7hl[local-Z00L-hal] 
   Solution 1: Following actions will be done: 
    do not ask to install a solvable providing droid-config 
    do not ask to install a solvable providing droid-config-sailfish 
   Solution 2: replacement of bluez-configs-mer-4.101+git73-1.31.1.armv7hl with droid-config-Z00L-bluez4-1-1.armv7hl 
   Solution 3: break droid-config-Z00L-1-1.armv7hl by ignoring some of its dependencies </p>
<p>Choose from above solutions by number or cancel [1/2/3/c] (c): c 
  error: Failed build dependencies: 
  droid-hal is needed by droid-hal-version-Z00L-0.0.1-1.armv7hl 
  droid-config is needed by droid-hal-version-Z00L-0.0.1-1.armv7hl 
  droid-config-sailfish is needed by droid-hal-version-Z00L-0.0.1-1.armv7hl 
  droid-hal-kernel is needed by droid-hal-version-Z00L-0.0.1-1.armv7hl 
  droid-hal-img-boot is needed by droid-hal-version-Z00L-0.0.1-1.armv7hl 
  droid-hal-img-recovery is needed by droid-hal-version-Z00L-0.0.1-1.armv7hl 
  droid-config-preinit-plugins is needed by droid-hal-version-Z00L-0.0.1-1.armv7hl 
  droid-config-pulseaudio-settings is needed by droid-hal-version-Z00L-0.0.1-1.armv7hl 
  * Check /home/ilnur/to/mer/android/droid/hybris/droid-hal-version-Z00L.log for full log.<br>
  !! building of package failed<br>
  ```</p>
<p><strong>Решение</strong></p>
<p><code>bash
  sb2 -t $VENDOR-$DEVICE-$PORT_ARCH -m sdk-install -R zypper rm bluez-configs-mer-4.101+git73-1.31.1.armv7hl</code></p>
<ul>
<li><strong>Ошибка</strong> возникает если пересобираем заново:</li>
</ul>
<div class="highlight"><pre><span></span>qemu:<span class="w"> </span>uncaught<span class="w"> </span>target<span class="w"> </span>signal<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="o">(</span>Segmentation<span class="w"> </span>fault<span class="o">)</span><span class="w"> </span>-<span class="w"> </span>core<span class="w"> </span>dumped

/var/tmp/rpm-tmp.RA6BXM:<span class="w"> </span>line<span class="w"> </span><span class="m">204</span>:<span class="w"> </span><span class="m">25812</span><span class="w"> </span>Segmentation<span class="w"> </span>fault<span class="w">      </span><span class="o">(</span>core<span class="w"> </span>dumped<span class="o">)</span><span class="w"> </span>/usr/lib/qt5/bin/kmap2qmap<span class="w"> </span>.//droid-configs-device/configs/droid.kmap<span class="w"> </span>.//droid-configs-device/configs/us.kmap<span class="w"> </span><span class="nv">$RPM_BUILD_ROOT</span>//usr/share/qt5/keymaps/droid.qmap

error:<span class="w"> </span>Bad<span class="w"> </span><span class="nb">exit</span><span class="w"> </span>status<span class="w"> </span>from<span class="w"> </span>/var/tmp/rpm-tmp.RA6BXM<span class="w"> </span><span class="o">(</span>%install<span class="o">)</span>

RPM<span class="w"> </span>build<span class="w"> </span>errors:
Bad<span class="w"> </span><span class="nb">exit</span><span class="w"> </span>status<span class="w"> </span>from<span class="w"> </span>/var/tmp/rpm-tmp.RA6BXM<span class="w"> </span><span class="o">(</span>%install<span class="o">)</span>
</pre></div>


<p><strong>Решение:</strong> </p>
<p>нужно выполнить заново <a href="http://www.kaefik.ru/2017/01/6-scratchbox2.html">6. Установка SCRATCHBOX2</a></p>
<h3>Это все проблемы с которыми я столкнулся при выполнения скрипта   rpm/dhd/helpers/build_packages.sh</h3>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="https://twitter.com/oILnur">Twitter</a></li>
                            <li><a href="mailto: ilnursoft@gmail.com">Email</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <p>Powered by <a href="http://getpelican.com/">Pelican</a>. Theme <a href="https://github.com/blueicefield/pelican-blueidea/">blueidea</a>, inspired by the default theme.</p>
        </footer><!-- /#contentinfo -->

</body>
</html>