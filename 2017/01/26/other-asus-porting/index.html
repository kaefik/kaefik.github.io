<!DOCTYPE html>
<html lang="ru">
<head>
        <meta charset="utf-8" />
        <title>Всяко разное интересное по портированию на Sailfish</title>
        <link rel="stylesheet" href="kaefik.ru/theme/css/main.css" />

        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
<a href="https://github.com/kaefik">
<img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub" />
</a>
        <header id="banner" class="body">
                <h1><a href="kaefik.ru/">Общественная записная книжка  <strong>следы для себя и потомков</strong></a></h1>
                <nav><ul>
                </ul>
<form id="search" action"#" onsubmit="javascript:window.open('https://duckduckgo.com/?q='+document.getElementById('keywords').value+'+site:kaefik.ru');">
                        <input id="keywords" type="text" />
                    </form>
                </nav>
<div id="submenu">
                    <ul>
                            <li><a href="kaefik.ru/category/anime.html">anime</a></li>
                            <li><a href="kaefik.ru/category/arduino.html">arduino</a></li>
                            <li><a href="kaefik.ru/category/bios.html">bios</a></li>
                            <li><a href="kaefik.ru/category/blogger.html">blogger</a></li>
                            <li><a href="kaefik.ru/category/chromeos.html">chromeos</a></li>
                            <li><a href="kaefik.ru/category/clojure.html">clojure</a></li>
                            <li><a href="kaefik.ru/category/design.html">design</a></li>
                            <li><a href="kaefik.ru/category/docker.html">docker</a></li>
                            <li><a href="kaefik.ru/category/game.html">game</a></li>
                            <li><a href="kaefik.ru/category/git.html">git</a></li>
                            <li><a href="kaefik.ru/category/go.html">go</a></li>
                            <li><a href="kaefik.ru/category/hackintosh.html">hackintosh</a></li>
                            <li><a href="kaefik.ru/category/internet.html">internet</a></li>
                            <li><a href="kaefik.ru/category/javascript.html">javascript</a></li>
                            <li><a href="kaefik.ru/category/lego.html">lego</a></li>
                            <li><a href="kaefik.ru/category/linux.html">linux</a></li>
                            <li><a href="kaefik.ru/category/lua.html">lua</a></li>
                            <li><a href="kaefik.ru/category/machine_learning.html">machine_learning</a></li>
                            <li><a href="kaefik.ru/category/main.html">main</a></li>
                            <li><a href="kaefik.ru/category/markdown.html">markdown</a></li>
                            <li><a href="kaefik.ru/category/miband.html">miband</a></li>
                            <li><a href="kaefik.ru/category/minecraft.html">minecraft</a></li>
                            <li><a href="kaefik.ru/category/miui.html">miui</a></li>
                            <li><a href="kaefik.ru/category/money.html">money</a></li>
                            <li><a href="kaefik.ru/category/mongodb.html">mongodb</a></li>
                            <li><a href="kaefik.ru/category/mouse.html">mouse</a></li>
                            <li><a href="kaefik.ru/category/network.html">network</a></li>
                            <li><a href="kaefik.ru/category/openstreetmap.html">openstreetmap</a></li>
                            <li><a href="kaefik.ru/category/os.html">os</a></li>
                            <li><a href="kaefik.ru/category/otkrytye-dannye.html">открытые данные</a></li>
                            <li><a href="kaefik.ru/category/postgis.html">postgis</a></li>
                            <li><a href="kaefik.ru/category/postgresql.html">PostgreSQL</a></li>
                            <li><a href="kaefik.ru/category/powershell.html">powershell</a></li>
                            <li><a href="kaefik.ru/category/programming.html">programming</a></li>
                            <li><a href="kaefik.ru/category/projects.html">projects</a></li>
                            <li><a href="kaefik.ru/category/python.html">python</a></li>
                            <li><a href="kaefik.ru/category/radio.html">radio</a></li>
                            <li><a href="kaefik.ru/category/rest-api.html">rest-api</a></li>
                            <li><a href="kaefik.ru/category/rust.html">rust</a></li>
                            <li class="active"><a href="kaefik.ru/category/sailfish.html">sailfish</a></li>
                            <li><a href="kaefik.ru/category/security.html">security</a></li>
                            <li><a href="kaefik.ru/category/selenium.html">selenium</a></li>
                            <li><a href="kaefik.ru/category/shell.html">shell</a></li>
                            <li><a href="kaefik.ru/category/swift.html">swift</a></li>
                            <li><a href="kaefik.ru/category/tatar.html">tatar</a></li>
                            <li><a href="kaefik.ru/category/video.html">video</a></li>
                            <li><a href="kaefik.ru/category/vim.html">vim</a></li>
                            <li><a href="kaefik.ru/category/voice-assistant.html">voice-assistant</a></li>
                            <li><a href="kaefik.ru/category/vscode.html">vscode</a></li>
                            <li><a href="kaefik.ru/category/web.html">web</a></li>
                            <li><a href="kaefik.ru/category/windows.html">windows</a></li>
                    </ul>
                <div>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="kaefik.ru/2017/01/26/other-asus-porting/" rel="bookmark"
           title="Permalink to Всяко разное интересное по портированию на Sailfish">Всяко разное интересное по портированию на Sailfish</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <span>Thu 26 January 2017</span>
<span>| tags: <a href="kaefik.ru/tag/asus.html">asus</a><a href="kaefik.ru/tag/porting.html">porting</a><a href="kaefik.ru/tag/sailfish.html">sailfish</a><a href="kaefik.ru/tag/z00l.html">z00l</a></span>
</footer><!-- /.post-info -->      <hr>
<p>tar -cvjf sfe-Z00L-2.0.5.6-my1.tar.bz2 ./</p>
<hr>
<p>https://github.com/stephgosling/android_device_htc_m7-common/commit/9f4abdca65356090e6dd6f0356c5cf4a1870aa5f</p>
<hr>
<p>https://github.com/stephgosling/android_device_htc_m7-common/commit/9f4abdca65356090e6dd6f0356c5cf4a1870aa5f</p>
<hr>
<p>Operating Blind on an Existing Device </p>
<p>Long story short, you will have to assume that you cannot:</p>
<p>• See any framebuffer console</p>
<p>• See any error messages of any kind during bootup</p>
<p>• Get any information relayed from your startup process</p>
<p>• Set any kind of modified kernel command lines</p>
<p>Hence, we have to learn how to operate blind on a device. The good news is that when you have a working kernel, you can combine it with a init ramdisk and that Android’s USB gadget is built in to most kernel configurations. It is possible then for the ramdisk to set up working USB networking on most devices and then open up a telnet daemon.</p>
<p>The hybris-boot repository contains such an initrd with convenient USB networking, DHCP and telnet server, plus the ability to boot into a Sailfish OS system. </p>
<p>The init system in the hybris-boot initrd will attempt to write information via the USB device serial number and model. </p>
<p>So <strong>dmesg</strong> on the host could produce:</p>
<div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1094634</span><span class="p">.</span><span class="mi">238136</span><span class="p">]</span> <span class="n">usb</span> <span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="n">Manufacturer</span><span class="p">:</span> <span class="n">Mer</span> <span class="n">Boat</span> <span class="n">Loader</span>

<span class="p">[</span><span class="mi">1094634</span><span class="p">.</span><span class="mi">238143</span><span class="p">]</span> <span class="n">usb</span> <span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="n">SerialNumber</span><span class="p">:</span> <span class="n">Mer</span> <span class="n">Debug</span> <span class="n">setting</span> <span class="n">up</span> <span class="p">(</span><span class="n">DONE_SWITCH</span><span class="o">=</span><span class="k">no</span><span class="p">)</span>
</pre></div>


<p>However dmesg doesn’t report all changes in the USB subsystem and the init script will attempt to update the iSerial field with information so also do:</p>
<div class="highlight"><pre><span></span>lsusb -v <span class="p">|</span> grep iSerial
</pre></div>


<p>iSerial 3 Mer Debug telnet on port 23 on rndis0 192.168.2.15 - also running udhcpd</p>
<p>However, if it says something like:</p>
<div class="highlight"><pre><span></span><span class="err">[1094634.238143] usb 2-2: SerialNumber: Mer Debug setting up (DONE_SWITCH=yes)</span>
</pre></div>


<p>connectivity will be available via <strong>telnet 192.168.2.15 2323</strong>  port.</p>
<p><strong>LIST OF REPOSITORIES</strong></p>
<ul>
<li>
<p><strong>droid-hal-$DEVICE</strong> Contains RPM packaging and conversion scripts for converting the results of the  Android HAL build process to RPM packages and systemd configuration files.</p>
</li>
<li>
<p><strong>hybris-boot</strong> Script run during Android HAL build that will combine the kernel and a custom initrd  to hybris-boot.img and hybris-recovery.img. Those are used to boot a device into    Sailfish OS and for development purposes.</p>
</li>
<li>
<p><strong>hybris-installer</strong> Combines the hybris-boot output and the root filesystem into a .zip file that can be flashed via Android Recovery.</p>
</li>
<li>
<p><strong>libhybris</strong> Library to allow access to Bionic-based libraries from a glibc-based host system (e.g. hw-composer, EGL, GLESv2, ..).</p>
</li>
<li>
<p><strong>qt5-qpa-hwcomposer-plugin</strong> Qt 5 Platform Abstraction Plugin that allows fullscreen rendering to the  Droid-based hardware abstraction. It utilizes libhybris and the Android hwcomposer module.</p>
</li>
<li>
<p><strong>mer-kernel-check</strong> A script that checks if the kernel configuration is suitable for Sailfish OS.</p>
</li>
</ul>
<p>​          Some features must be enabled, as they are needed on Sailfish OS (e.g. to sup-port systemd), other features must be disabled, as they conflict with Sailfish OS (e.g.        CONFIG_ANDROID_PARANOID_NETWORK) at the moment.</p>
<p><a href="https://draft.blogger.com/goog_2044954234">link_without_label</a>
<a href="http://neochapay.ru/blogs/zapiski-utkonosa-programmista/sailfish-os-vklyuchit-set-na-nezagruzhay.html">http://neochapay.ru/blogs/zapiski-utkonosa-programmista/sailfish-os-vklyuchit-set-na-nezagruzhay.html</a></p>
<p>​              SAILFISH OS - ВКЛЮЧИТЬ СЕТЬ НА НЕЗАГРУЖАЮЩЕМСЯ УСТРОЙСТВЕ</p>
<p><strong>Задача:</strong> </p>
<p>Есть устройство и оно грузится...как то...но не подобраться к нему. Задача подключить DevMode и соотвествено сеть через USB</p>
<p><strong>Решение</strong> </p>
<p>Через recovery или как то другим способом создаём файл в корне sailfish:</p>
<p>/var/lib/environment/usb-moded/alwaysdevmode.conf</p>
<p>То есть если через рековери то будет  /data/.stowaways/sailfishos/var/lib/environment/usb-moded/alwaysdevmode.conf</p>
<p>​              С содержимым:</p>
<div class="highlight"><pre><span></span><span class="n">USB_MODED_ARGS</span><span class="o">=-</span><span class="n">r</span>
<span class="c1">-------------------------</span>

<span class="err">И</span> <span class="err">ещё</span> <span class="err">для</span> <span class="err">коллекции</span> <span class="err">в</span> <span class="o">#</span><span class="n">geekfaq</span><span class="p">.</span> <span class="err">Настройки</span> <span class="n">ssu</span><span class="p">,</span> <span class="err">такие</span> <span class="err">как</span> <span class="err">название</span> <span class="err">модели</span><span class="p">,</span> <span class="err">хранятся</span> <span class="err">здесь</span><span class="p">:</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">share</span><span class="o">/</span><span class="n">ssu</span><span class="o">/</span><span class="n">board</span><span class="o">-</span><span class="n">mappings</span><span class="p">.</span><span class="n">d</span><span class="o">/</span> 
</pre></div>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="https://twitter.com/oILnur">Twitter</a></li>
                            <li><a href="mailto: ilnursoft@gmail.com">Email</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <p>Powered by <a href="http://getpelican.com/">Pelican</a>. Theme <a href="https://github.com/blueicefield/pelican-blueidea/">blueidea</a>, inspired by the default theme.</p>
        </footer><!-- /#contentinfo -->

</body>
</html>